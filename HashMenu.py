import hashlib

def hash_menu():
    choice = ''
    while (choice != '4'):
        print("Hash Menu")
        print("1- Hash message using MD5")
        print("2- Hash message using SHA-1")
        print("3- Hash message using SHA256")
        print("4- Back")
        choice = input("> ")
        if (choice == '1'):
            message = input("Enter message to hash:\n> ")
            hashed_message = md5_hash(message)
            print(f"Hashed message: {hashed_message}")
        if (choice == '2'):
            message = input("Enter message to hash:\n> ")
            hashed_message = sha1_hash(message)
            print(f"Hashed message: {hashed_message}")
        if (choice == '3'):
            message = input("Enter message to hash:\n> ")
            hashed_message = sha256_hash(message)
            print(f"Hashed message: {hashed_message}")

def hash_crack_menu():
    choice = ''
    while (choice != '4'):
        print("Hash Crack Menu")
        print("1- Crack hashed message using MD5")
        print("2- Crack hashed message using SHA-1")
        print("3- Crack hashed message using SHA256")
        print("4- Back")
        choice = input("> ")
        if (choice == '1'):
            hashed_message = input("Enter hashed message:\n> ")
            with open('insat.dic', 'r') as f:
                lines = f.readlines()
                for line in lines:
                    if (md5_hash(line.strip()) == hashed_message):
                        print("E-mail cracked.")
                        print(f"E-mail : {line}")
                        break
        if (choice == '2'):
            hashed_message = input("Enter hashed message:\n> ")
            with open('insat.dic', 'r') as f:
                lines = f.readlines()
                for line in lines:
                    if (sha1_hash(line) == hashed_message):
                        print("E-mail cracked.")
                        print(f"E-mail : {line}")
                        break
        if (choice == '3'):
            hashed_message = input("Enter hashed message:\n> ")
            with open('insat.dic', 'r') as f:
                lines = f.readlines()
                for line in lines:
                    if (sha256_hash(line) == hashed_message):
                        print("E-mail cracked.")
                        print(f"E-mail : {line}")
                        break

def md5_hash(message: str):
    return hashlib.md5(message.encode()).hexdigest()

def sha1_hash(message: str):
    return hashlib.sha1(message.encode()).hexdigest()

def sha256_hash(message: str):
    return hashlib.sha256(message.encode()).hexdigest()