from AESCipher import AESCipher
from DESCipher import DESCipher




def sym_menu():
    choice = ''
    while(choice != '3'):
        print("Symmetric Cipher")
        print("1- DES")
        print("2- AES256")
        print("3- Back")
        choice = input("> ")
        if (choice == "1"):
            des_algorithm()
        elif (choice == "2"):
            aes_algorithm()

def des_algorithm():
    choice = ''
    while(choice != '3'):
        print("1- Encrypt message")
        print("2- Decrypt message")
        print("3- Back")
        choice = input("> ")
        if (choice == "1"):
            key = input("Enter key (must be of length 8):\n> ")
            message = input("Enter message:\n> ")
            descipher = DESCipher(bytes(key.encode()))
            ciphertext = descipher.encrypt(bytes(message.encode()))
            print("The ciphertext(in hexadecimal): ", ciphertext.hex())
            filename = input("Enter where to save encrypted message:\n> ")
            with open(filename, 'wb') as f:
                f.write(ciphertext)
            continue
        if (choice == "2"):
            key = input("Enter key (must be of length 8):\n> ")
            filename = input("Enter encrypted file name:\n> ")
            with open(filename, 'rb') as f:
                enc_message = f.read()
            descipher = DESCipher(bytes(key.encode()))
            plaintext = descipher.decrypt(enc_message)
            print("The plaintext: ", plaintext)
            continue

def aes_algorithm():
    choice =''
    while(choice != '3'):
        print("1- Encrypt message")
        print("2- Decrypt message")
        print("3- Back")
        choice = input("> ")
        if (choice == "1"):
            key = input("Enter key :\n> ")
            message = input("Enter message:\n> ")
            aescipher = AESCipher(key)
            ciphertext = aescipher.encrypt(message)
            print("The ciphertext: ", ciphertext.decode())
            continue
        if (choice == "2"):
            key = input("Enter key :\n> ")
            enc_message = input("Enter encrypted message:\n> ")
            aescipher = AESCipher(key)
            plaintext = aescipher.decrypt(enc_message)
            print("The plaintext: ", plaintext)
            continue
